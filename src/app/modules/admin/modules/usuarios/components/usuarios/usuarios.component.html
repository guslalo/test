<div class="row">
  <div class="col mb-2">
    <h2>Gesti√≥n de Usuarios</h2>
  </div>
</div>

<ngb-toast *ngIf="emailSent" class="bg-success text-light" [delay]="5000" [autohide]="true" (hide)="emailSent = false">
  <div>Correo Enviado Exitosamente</div>
</ngb-toast>

<div class="row">
  <div class="col-12">
    <!-- TABS -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <a
          class="nav-link"
          id="admin-tab"
          data-toggle="tab"
          href="#admins"
          role="tab"
          aria-controls="home"
          aria-selected="true"
          (click)="changeTab('admins')"
        >
          <i
            width="1em"
            height="1em"
            viewBox="0 0 16 16"
            class="bi bi-clipboard-data"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
          >
          </i>
          Administradores
        </a>
      </li>
      <li class="nav-item" role="presentation">
        <a
          class="nav-link"
          id="professional-tab"
          data-toggle="tab"
          href="#professionals"
          role="tab"
          aria-controls="profile"
          aria-selected="false"
          (click)="changeTab('professionals')"
        >
          <i
            width="1em"
            height="1em"
            viewBox="0 0 16 16"
            class="bi bi-calendar3-fill"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
          >
          </i>
          Profesionales de Salud
        </a>
      </li>
      <li class="nav-item" role="presentation">
        <a
          class="nav-link"
          id="coordinator-tab"
          data-toggle="tab"
          href="#coordinators"
          role="tab"
          aria-controls="profile"
          aria-selected="false"
          (click)="changeTab('coordinators')"
        >
          <i
            width="1em"
            height="1em"
            viewBox="0 0 16 16"
            class="bi bi-calendar3-fill"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
          >
          </i>
          Coordinadores
        </a>
      </li>
      <li class="nav-item" role="presentation">
        <a
          class="nav-link"
          id="patients-tab"
          data-toggle="tab"
          href="#patients"
          role="tab"
          aria-controls="profile"
          aria-selected="false"
          (click)="changeTab('patients')"
        >
          <i
            width="1em"
            height="1em"
            viewBox="0 0 16 16"
            class="bi bi-calendar3-fill"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
          >
          </i>
          Pacientes
        </a>
      </li>
    </ul>
    <div class="tab-content pt-3" id="tab-content">
      <div class="tab-pane fade show active" id="admins" role="tabpanel">
        <!-- FILTERS -->
        <div class="row mt-2">
          <div class="col-12 col-md-3">
            <input
              [(ngModel)]="searchTerm"
              id="typeahead-basic"
              type="text"
              class="form-control"
              placeholder="Busqueda"
              (keyup)="applyFilters()"
            />
            <div class="searchBox">
              <svg
                width="1em"
                height="1em"
                viewBox="0 0 16 16"
                class="bi bi-search"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"
                />
                <path
                  fill-rule="evenodd"
                  d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"
                />
              </svg>
            </div>
          </div>
          <div class="col-12 col-md-3">
            <div class="form-group">
              <select
                [(ngModel)]="profileSelected"
                class="form-control"
                id="exampleFormControlSelect1"
                (change)="applyFilters()"
              >
                <option [ngValue]="null">Filtro por Perfil</option>
                <option [ngValue]="profile.id" *ngFor="let profile of profiles">
                  {{ profile.role }} - {{ profile.profileName }}
                </option>
              </select>
            </div>
          </div>
          <div class="col-12 col-md-6 float-right">
            <button
              type="button"
              class="btn btn-secondary rounded-pill float-right"
              ng-reflect-tour-anchor="agendar"
              data-toggle="modal"
              data-target="#disponibilidad"
              [routerLink]="['crear-usuario']"
              [queryParams]="{ userType: 'admin' }"
            >
              Nuevo Administrador
              <svg
                width="1.5em"
                height="1.5em"
                viewBox="0 0 16 16"
                class="bi bi-plus-circle"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M8 3.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H4a.5.5 0 0 1 0-1h3.5V4a.5.5 0 0 1 .5-.5z"
                />
                <path fill-rule="evenodd" d="M7.5 8a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H8.5V12a.5.5 0 0 1-1 0V8z" />
                <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
              </svg>
            </button>
          </div>
        </div>
        <!-- ADMINS TABLE -->
        <div class="row mt-1">
          <div class="col-12 mb-4">
            <div class="tableBox rounded p-4 bg-white">
              <ngx-datatable
                *ngIf="users.length"
                #table
                class="material"
                [rows]="users"
                headerHeight="auto"
                footerHeight="auto"
                rowHeight="70"
                [columnMode]="ColumnMode.flex"
                [limit]="7"
                [selected]="selected"
                [selectionType]="SelectionType.checkbox"
                [selectAllRowsOnPage]="true"
                (select)="onSelect($event)"
              >
                <!-- MULTISELECT -->
                <ngx-datatable-column [width]="30" [sortable]="false" [draggable]="false" [resizeable]="false">
                  <ng-template
                    ngx-datatable-header-template
                    let-value="value"
                    let-allRowsSelected="allRowsSelected"
                    let-selectFn="selectFn"
                  >
                    <input
                      class="mb-n2"
                      [ngStyle]="{ height: '24px' }"
                      type="checkbox"
                      [checked]="allRowsSelected"
                      (change)="selectFn(!allRowsSelected)"
                    />
                  </ng-template>
                  <ng-template
                    ngx-datatable-cell-template
                    let-row="row"
                    let-isSelected="isSelected"
                    let-onCheckboxChangeFn="onCheckboxChangeFn"
                  >
                    <input
                      class="mb-n2"
                      [ngStyle]="{ height: '24px' }"
                      type="checkbox"
                      [checked]="isSelected"
                      (change)="onCheckboxChangeFn($event)"
                    />
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="1"
                  prop="nationalId"
                  name="ID"
                ></ngx-datatable-column>
                <ngx-datatable-column [resizeable]="false" [flexGrow]="3" prop="fullName" name="Nombre">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <a>
                      <img class="mr-2" id="image0" width="38" height="38" src="/assets/perfil.png" alt="img" />
                      {{ row.fullName }}
                    </a>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="3"
                  prop="email"
                  name="Correo"
                ></ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="2"
                  prop="phone"
                  name="Telefono"
                ></ngx-datatable-column>
                <ngx-datatable-column [resizeable]="false" [flexGrow]="2" prop="status" name="Estado">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <button
                      type="button"
                      class="btn btn-sm rounded-pill"
                      [ngClass]="{
                        'btn-primary': row.status === 'Activo',
                        'btn-secondary ': row.status === 'Pendiente',
                        'btn-light ': row.status === 'Deshabilitado'
                      }"
                    >
                      {{ row.status }}
                    </button>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column [sortable]="false" [flexGrow]="2" name="Acciones">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <div data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" disabled>
                      <button class="btn btn-light btn-sm rounded-pill">
                        <svg
                          width="1em"
                          height="1em"
                          viewBox="0 0 16 16"
                          class="bi bi-three-dots"
                          fill="currentColor"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            fill-rule="evenodd"
                            d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"
                          />
                        </svg>
                      </button>
                    </div>
                    <div class="dropdown-menu dropdown-menu-right">
                      <button
                        data-toggle="modal"
                        data-target="#editar"
                        class="dropdown-item"
                        type="button"
                        [routerLink]="['editar-usuario']"
                        [queryParams]="{ userType: 'admins', userId: row.id }"
                      >
                        Editar
                      </button>
                      <button
                        class="dropdown-item"
                        type="button"
                        data-toggle="modal"
                        data-target="#disableUserModal"
                        (click)="openDeactivateUserModal(deactivateUserModal, row.id)"
                        [disabled]="row.status !== 'Activo'"
                      >
                        Eliminar
                      </button>
                      <button
                        class="dropdown-item"
                        type="button"
                        data-toggle="modal"
                        data-target="#sendInvitationModal"
                        (click)="openSendInvitationModal(sendInvitationModal, row.id)"
                      >
                        Enviar Invitacion a Correo
                      </button>
                    </div>
                  </ng-template>
                </ngx-datatable-column>
              </ngx-datatable>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade show" id="professionals" role="tabpanel">
        <!-- FILTERS -->
        <div class="row mt-2">
          <div class="col-12 col-md-3">
            <input
            [(ngModel)]="searchTerm"
              id="typeahead-basic"
              type="text"
              class="form-control"
              placeholder="Busqueda"
              (keyup)="applyFilters()"
            />
            <div class="searchBox">
              <svg
                width="1em"
                height="1em"
                viewBox="0 0 16 16"
                class="bi bi-search"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"
                />
                <path
                  fill-rule="evenodd"
                  d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"
                />
              </svg>
            </div>
          </div>
          <div class="col-12 col-md-3">
            <div class="form-group">
              <select
                [(ngModel)]="profileSelected"
                class="form-control"
                id="exampleFormControlSelect1"
                (change)="applyFilters()"
              >
                <option [ngValue]="null">Filtro por Perfil</option>
                <option [ngValue]="profile.id" *ngFor="let profile of profiles">
                  {{ profile.role }} - {{ profile.profileName }}
                </option>
              </select>
            </div>
          </div>
          <div class="col-12 col-md-6 float-right">
            <button
              type="button"
              class="btn btn-secondary rounded-pill float-right"
              ng-reflect-tour-anchor="agendar"
              data-toggle="modal"
              data-target="#disponibilidad"
              [routerLink]="['crear-usuario']"
              [queryParams]="{ userType: 'professional' }"
            >
              Nuevo Profesional
              <svg
                width="1.5em"
                height="1.5em"
                viewBox="0 0 16 16"
                class="bi bi-plus-circle"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M8 3.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H4a.5.5 0 0 1 0-1h3.5V4a.5.5 0 0 1 .5-.5z"
                />
                <path fill-rule="evenodd" d="M7.5 8a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H8.5V12a.5.5 0 0 1-1 0V8z" />
                <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
              </svg>
            </button>
          </div>
        </div>
        <!-- PROFESSIONALS TABLE -->
        <div class="row mt-1">
          <div class="col-12 mb-4">
            <div class="tableBox rounded p-4 bg-white">
              <ngx-datatable
                *ngIf="users.length"
                #table
                class="material"
                [rows]="users"
                headerHeight="auto"
                footerHeight="auto"
                rowHeight="70"
                [columnMode]="ColumnMode.flex"
                [limit]="7"
                [selected]="selected"
                [selectionType]="SelectionType.checkbox"
                [selectAllRowsOnPage]="true"
                (select)="onSelect($event)"
              >
                <!-- MULTISELECT -->
                <ngx-datatable-column [width]="30" [sortable]="false" [draggable]="false" [resizeable]="false">
                  <ng-template
                    ngx-datatable-header-template
                    let-value="value"
                    let-allRowsSelected="allRowsSelected"
                    let-selectFn="selectFn"
                  >
                    <input
                      class="mb-n2"
                      [ngStyle]="{ height: '24px' }"
                      type="checkbox"
                      [checked]="allRowsSelected"
                      (change)="selectFn(!allRowsSelected)"
                    />
                  </ng-template>
                  <ng-template
                    ngx-datatable-cell-template
                    let-row="row"
                    let-isSelected="isSelected"
                    let-onCheckboxChangeFn="onCheckboxChangeFn"
                  >
                    <input
                      class="mb-n2"
                      [ngStyle]="{ height: '24px' }"
                      type="checkbox"
                      [checked]="isSelected"
                      (change)="onCheckboxChangeFn($event)"
                    />
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="1"
                  prop="nationalId"
                  name="ID"
                ></ngx-datatable-column>
                <ngx-datatable-column [resizeable]="false" [flexGrow]="3" prop="fullName" name="Nombre">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <a>
                      <img class="mr-2" id="image0" width="38" height="38" src="/assets/perfil.png" alt="img" />
                      {{ row.fullName }}
                    </a>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="3"
                  prop="email"
                  name="Correo"
                ></ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="2"
                  prop="phone"
                  name="Telefono"
                ></ngx-datatable-column>
                <ngx-datatable-column [resizeable]="false" [flexGrow]="2" prop="status" name="Estado">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <button
                      type="button"
                      class="btn btn-sm rounded-pill"
                      [ngClass]="{
                        'btn-primary': row.status === 'Activo',
                        'btn-secondary ': row.status === 'Pendiente',
                        'btn-light ': row.status === 'Deshabilitado'
                      }"
                    >
                      {{ row.status }}
                    </button>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column [sortable]="false" [flexGrow]="2" name="Acciones">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <div data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" disabled>
                      <button class="btn btn-light btn-sm rounded-pill">
                        <svg
                          width="1em"
                          height="1em"
                          viewBox="0 0 16 16"
                          class="bi bi-three-dots"
                          fill="currentColor"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            fill-rule="evenodd"
                            d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"
                          />
                        </svg>
                      </button>
                    </div>
                    <div class="dropdown-menu dropdown-menu-right">
                      <button
                        data-toggle="modal"
                        data-target="#editar"
                        class="dropdown-item"
                        type="button"
                        [routerLink]="['editar-usuario']"
                        [queryParams]="{ userType: 'professionals', userId: row.id }"
                      >
                        Editar
                      </button>
                      <button
                        class="dropdown-item"
                        type="button"
                        data-toggle="modal"
                        data-target="#disableUserModal"
                        (click)="openDeactivateUserModal(deactivateUserModal, row.id)"
                        [disabled]="row.status !== 'Activo'"
                      >
                        Eliminar
                      </button>
                      <button
                        class="dropdown-item"
                        type="button"
                        data-toggle="modal"
                        data-target="#sendInvitationModal"
                        (click)="openSendInvitationModal(sendInvitationModal, row.id)"
                      >
                        Enviar Invitacion a Correo
                      </button>
                    </div>
                  </ng-template>
                </ngx-datatable-column>
              </ngx-datatable>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade show" id="coordinators" role="tabpanel">
        <!-- FILTERS -->
        <div class="row mt-2">
          <div class="col-12 col-md-3">
            <input
            [(ngModel)]="searchTerm"
              id="typeahead-basic"
              type="text"
              class="form-control"
              placeholder="Busqueda"
              (keyup)="applyFilters()"
            />
            <div class="searchBox">
              <svg
                width="1em"
                height="1em"
                viewBox="0 0 16 16"
                class="bi bi-search"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"
                />
                <path
                  fill-rule="evenodd"
                  d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"
                />
              </svg>
            </div>
          </div>
          <div class="col-12 col-md-3">
            <div class="form-group">
              <select
                [(ngModel)]="profileSelected"
                class="form-control"
                id="exampleFormControlSelect1"
                (change)="applyFilters()"
              >
                <option [ngValue]="null">Filtro por Perfil</option>
                <option [ngValue]="profile.id" *ngFor="let profile of profiles">
                  {{ profile.role }} - {{ profile.profileName }}
                </option>
              </select>
            </div>
          </div>
          <div class="col-12 col-md-6 float-right">
            <button
              type="button"
              class="btn btn-secondary rounded-pill float-right"
              ng-reflect-tour-anchor="agendar"
              data-toggle="modal"
              data-target="#disponibilidad"
              [routerLink]="['crear-usuario']"
              [queryParams]="{ userType: 'coordinator' }"
            >
              Nuevo Coordinador
              <svg
                width="1.5em"
                height="1.5em"
                viewBox="0 0 16 16"
                class="bi bi-plus-circle"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M8 3.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H4a.5.5 0 0 1 0-1h3.5V4a.5.5 0 0 1 .5-.5z"
                />
                <path fill-rule="evenodd" d="M7.5 8a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H8.5V12a.5.5 0 0 1-1 0V8z" />
                <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
              </svg>
            </button>
          </div>
        </div>
        <!-- COORDINATORS TABLE -->
        <div class="row mt-1">
          <div class="col-12 mb-4">
            <div class="tableBox rounded p-4 bg-white">
              <ngx-datatable
                *ngIf="users.length"
                #table
                class="material"
                [rows]="users"
                headerHeight="auto"
                footerHeight="auto"
                rowHeight="70"
                [columnMode]="ColumnMode.flex"
                [limit]="7"
                [selected]="selected"
                [selectionType]="SelectionType.checkbox"
                [selectAllRowsOnPage]="true"
                (select)="onSelect($event)"
              >
                <!-- MULTISELECT -->
                <ngx-datatable-column [width]="30" [sortable]="false" [draggable]="false" [resizeable]="false">
                  <ng-template
                    ngx-datatable-header-template
                    let-value="value"
                    let-allRowsSelected="allRowsSelected"
                    let-selectFn="selectFn"
                  >
                    <input
                      class="mb-n2"
                      [ngStyle]="{ height: '24px' }"
                      type="checkbox"
                      [checked]="allRowsSelected"
                      (change)="selectFn(!allRowsSelected)"
                    />
                  </ng-template>
                  <ng-template
                    ngx-datatable-cell-template
                    let-row="row"
                    let-isSelected="isSelected"
                    let-onCheckboxChangeFn="onCheckboxChangeFn"
                  >
                    <input
                      class="mb-n2"
                      [ngStyle]="{ height: '24px' }"
                      type="checkbox"
                      [checked]="isSelected"
                      (change)="onCheckboxChangeFn($event)"
                    />
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="1"
                  prop="nationalId"
                  name="ID"
                ></ngx-datatable-column>
                <ngx-datatable-column [resizeable]="false" [flexGrow]="3" prop="fullName" name="Nombre">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <a>
                      <img class="mr-2" id="image0" width="38" height="38" src="/assets/perfil.png" alt="img" />
                      {{ row.fullName }}
                    </a>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="3"
                  prop="email"
                  name="Correo"
                ></ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="2"
                  prop="phone"
                  name="Telefono"
                ></ngx-datatable-column>
                <ngx-datatable-column [resizeable]="false" [flexGrow]="2" prop="status" name="Estado">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <button
                      type="button"
                      class="btn btn-sm rounded-pill"
                      [ngClass]="{
                        'btn-primary': row.status === 'Activo',
                        'btn-secondary ': row.status === 'Pendiente',
                        'btn-light ': row.status === 'Deshabilitado'
                      }"
                    >
                      {{ row.status }}
                    </button>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column [sortable]="false" [flexGrow]="2" name="Acciones">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <div data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" disabled>
                      <button class="btn btn-light btn-sm rounded-pill">
                        <svg
                          width="1em"
                          height="1em"
                          viewBox="0 0 16 16"
                          class="bi bi-three-dots"
                          fill="currentColor"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            fill-rule="evenodd"
                            d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"
                          />
                        </svg>
                      </button>
                    </div>
                    <div class="dropdown-menu dropdown-menu-right">
                      <button
                        data-toggle="modal"
                        data-target="#editar"
                        class="dropdown-item"
                        type="button"
                        [routerLink]="['editar-usuario']"
                        [queryParams]="{ userType: 'coordinators', userId: row.id }"
                      >
                        Editar
                      </button>
                      <button
                        class="dropdown-item"
                        type="button"
                        data-toggle="modal"
                        data-target="#disableUserModal"
                        (click)="openDeactivateUserModal(deactivateUserModal, row.id)"
                        [disabled]="row.status !== 'Activo'"
                      >
                        Eliminar
                      </button>
                      <button
                        class="dropdown-item"
                        type="button"
                        data-toggle="modal"
                        data-target="#sendInvitationModal"
                        (click)="openSendInvitationModal(sendInvitationModal, row.id)"
                      >
                        Enviar Invitacion a Correo
                      </button>
                    </div>
                  </ng-template>
                </ngx-datatable-column>
              </ngx-datatable>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade show" id="patients" role="tabpanel">
        <!-- FILTERS -->
        <div class="row mt-2">
          <div class="col-12 col-md-3">
            <input
            [(ngModel)]="searchTerm"
              id="typeahead-basic"
              type="text"
              class="form-control"
              placeholder="Busqueda"
              (keyup)="applyFilters()"
            />
            <div class="searchBox">
              <svg
                width="1em"
                height="1em"
                viewBox="0 0 16 16"
                class="bi bi-search"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"
                />
                <path
                  fill-rule="evenodd"
                  d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"
                />
              </svg>
            </div>
          </div>
          <div class="col-12 col-md-1">
            <button type="button" class="btn btn-light" (click)="exportAsExcelFile()" [disabled]="!selected.length">
              <img src="assets/img/icon-export-excel.svg" />
            </button>
          </div>
          <div class="col-12 col-md-8 float-right">
            <button
              type="button"
              class="btn btn-secondary rounded-pill float-right"
              ng-reflect-tour-anchor="agendar"
              data-toggle="modal"
              data-target="#disponibilidad"
              data-toggle="modal"
              data-target="#patientModal"
              (click)="openPatientModal('create')"
            >
              Nuevo Paciente
              <svg
                width="1.5em"
                height="1.5em"
                viewBox="0 0 16 16"
                class="bi bi-plus-circle"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M8 3.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H4a.5.5 0 0 1 0-1h3.5V4a.5.5 0 0 1 .5-.5z"
                />
                <path fill-rule="evenodd" d="M7.5 8a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H8.5V12a.5.5 0 0 1-1 0V8z" />
                <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
              </svg>
            </button>
          </div>
        </div>
        <!-- PATIENTS TABLE -->
        <div class="row mt-3">
          <div class="col-12 mb-4">
            <div class="tableBox rounded p-4 bg-white">
              <ngx-datatable
                *ngIf="users.length"
                #table
                class="material"
                [rows]="users"
                headerHeight="auto"
                footerHeight="auto"
                rowHeight="70"
                [columnMode]="ColumnMode.flex"
                [limit]="7"
                [selected]="selected"
                [selectionType]="SelectionType.checkbox"
                [selectAllRowsOnPage]="true"
                (select)="onSelect($event)"
              >
                <!-- MULTISELECT -->
                <ngx-datatable-column [width]="30" [sortable]="false" [draggable]="false" [resizeable]="false">
                  <ng-template
                    ngx-datatable-header-template
                    let-value="value"
                    let-allRowsSelected="allRowsSelected"
                    let-selectFn="selectFn"
                  >
                    <input
                      class="mb-n2"
                      [ngStyle]="{ height: '24px' }"
                      type="checkbox"
                      [checked]="allRowsSelected"
                      (change)="selectFn(!allRowsSelected)"
                    />
                  </ng-template>
                  <ng-template
                    ngx-datatable-cell-template
                    let-row="row"
                    let-isSelected="isSelected"
                    let-onCheckboxChangeFn="onCheckboxChangeFn"
                  >
                    <input
                      class="mb-n2"
                      [ngStyle]="{ height: '24px' }"
                      type="checkbox"
                      [checked]="isSelected"
                      (change)="onCheckboxChangeFn($event)"
                    />
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="1"
                  prop="nationalId"
                  name="ID"
                ></ngx-datatable-column>
                <ngx-datatable-column [resizeable]="false" [flexGrow]="3" prop="fullName" name="Nombre">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <a>
                      <img class="mr-2" id="image0" width="38" height="38" src="/assets/perfil.png" alt="img" />
                      {{ row.fullName }}
                    </a>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="3"
                  prop="email"
                  name="Correo"
                ></ngx-datatable-column>
                <ngx-datatable-column
                  [resizeable]="false"
                  [flexGrow]="2"
                  prop="phone"
                  name="Telefono"
                ></ngx-datatable-column>
                <ngx-datatable-column [resizeable]="false" [flexGrow]="2" prop="status" name="Estado">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <button
                      type="button"
                      class="btn btn-sm rounded-pill"
                      [ngClass]="{
                        'btn-primary': row.status === 'Activo',
                        'btn-secondary ': row.status === 'Pendiente',
                        'btn-light ': row.status === 'Deshabilitado'
                      }"
                    >
                      {{ row.status }}
                    </button>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column [resizeable]="false" [sortable]="false" [flexGrow]="2" name="Acciones">
                  <ng-template let-row="row" ngx-datatable-cell-template>
                    <div data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" disabled>
                      <button class="btn btn-light btn-sm rounded-pill">
                        <svg
                          width="1em"
                          height="1em"
                          viewBox="0 0 16 16"
                          class="bi bi-three-dots"
                          fill="currentColor"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            fill-rule="evenodd"
                            d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"
                          />
                        </svg>
                      </button>
                    </div>
                    <div class="dropdown-menu dropdown-menu-right">
                      <button
                        data-toggle="modal"
                        data-target="#editar"
                        class="dropdown-item"
                        type="button"
                        (click)="openPatientModal('update', row.id)"
                      >
                        Editar
                      </button>
                      <button
                        class="dropdown-item"
                        type="button"
                        data-toggle="modal"
                        data-target="#disableUserModal"
                        (click)="openDeactivateUserModal(deactivateUserModal, row.id)"
                        [disabled]="row.status !== 'Activo'"
                      >
                        Eliminar
                      </button>
                      <button
                        class="dropdown-item"
                        type="button"
                        data-toggle="modal"
                        data-target="#sendInvitationModal"
                        (click)="openSendInvitationModal(sendInvitationModal, row.id)"
                      >
                        Enviar Invitacion a Correo
                      </button>
                    </div>
                  </ng-template>
                </ngx-datatable-column>
              </ngx-datatable>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- PATIENT MODAL -->
    <div
      #patientModal
      class="modal fade"
      id="patientModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title text-center w-100 mt-1">{{ !isEdit ? 'Crear' : 'Actualizar' }} Paciente</h5>
          </div>
          <div class="modal-body p-4">
            <form [formGroup]="patientForm">
              <div class="custom-control custom-switch mb-4">
                <input type="checkbox" class="custom-control-input" id="isTutor" formControlName="isTutor" />
                <label class="custom-control-label" for="isTutor">Cuenta Tutor</label>
              </div>

              <div class="row">
                <div class="form-group col">
                  <label for="name">Nombre</label>
                  <input
                    type="text"
                    class="form-control"
                    name="name"
                    formControlName="name"
                    [ngClass]="{
                      'is-invalid': !patientForm.get('name').valid && patientForm.get('name').touched
                    }"
                  />
                </div>
                <div class="form-group col">
                  <label for="lastName">Apellido</label>
                  <input
                    type="email"
                    class="form-control"
                    name="lastName"
                    formControlName="lastName"
                    [ngClass]="{
                      'is-invalid': !patientForm.get('lastName').valid && patientForm.get('lastName').touched
                    }"
                  />
                </div>
              </div>

              <div class="row">
                <div class="form-group col">
                  <label for="genre">Sexo</label>
                  <select
                    class="form-control"
                    name="genre"
                    formControlName="genre"
                    [ngClass]="{
                      'is-invalid': !patientForm.get('genre').valid && patientForm.get('genre').touched
                    }"
                  >
                    <option value="male">Masculino</option>
                    <option value="female">Femenino</option>
                  </select>
                </div>
                <div class="form-group col">
                  <label for="email">Email</label>
                  <input
                    type="email"
                    class="form-control"
                    name="email"
                    formControlName="email"
                    [ngClass]="{
                      'is-invalid': !patientForm.get('email').valid && patientForm.get('email').touched
                    }"
                  />
                </div>
              </div>

              <div class="row">
                <div class="form-group col">
                  <label for="phoneNumber">Telefono</label>
                  <input
                    type="text"
                    class="form-control"
                    name="phoneNumber"
                    formControlName="phoneNumber"
                    [ngClass]="{
                      'is-invalid': !patientForm.get('phoneNumber').valid && patientForm.get('phoneNumber').touched
                    }"
                  />
                </div>
                <div class="form-group col">
                  <label for="idDocumentNumber">Identificaci√≥n</label>
                  <input
                    type="email"
                    class="form-control"
                    name="idDocumentNumber"
                    formControlName="idDocumentNumber"
                    [ngClass]="{
                      'is-invalid':
                        !patientForm.get('idDocumentNumber').valid && patientForm.get('idDocumentNumber').touched
                    }"
                  />
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer text-center justify-content-center">
            <button type="button" class="btn btn-outline-primary rounded-pill" data-dismiss="modal">
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary rounded-pill"
              data-dismiss="modal"
              (click)="savePatient()"
              [disabled]="!patientForm.valid"
            >
              {{ !isEdit ? 'Crear' : 'Actualizar' }} Paciente
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- DISABLE USER MODAL -->
    <div
      #deactivateUserModal
      class="modal fade"
      id="disableUserModal"
      tabindex="-1"
      aria-labelledby="disableUserModal"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title text-center w-100 mt-1">Deshabilitar Usuario</h5>
          </div>
          <div class="modal-body p-4">
            <p class="text-center">¬øEstas seguro de que deseas deshabilitar a este usuario?</p>
          </div>
          <div class="modal-footer text-center justify-content-center">
            <button type="button" class="btn btn-outline-primary rounded-pill" data-dismiss="modal">
              Cancelar
            </button>
            <button type="button" class="btn btn-primary rounded-pill" data-dismiss="modal" (click)="deactivateUser()">
              Confirmar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- SEND INVITATION MODAL -->
    <div
      #sendInvitationModal
      class="modal fade"
      id="sendInvitationModal"
      tabindex="-1"
      aria-labelledby="sendInvitationModal"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title text-center w-100 mt-1">Enviar Correo de Confirmacion</h5>
          </div>
          <div class="modal-footer text-center justify-content-center">
            <button type="button" class="btn btn-outline-primary rounded-pill" data-dismiss="modal">
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary rounded-pill"
              data-dismiss="modal"
              (click)="sendInvitationEmail()"
            >
              Confirmar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
